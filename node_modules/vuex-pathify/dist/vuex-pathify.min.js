!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.VuexPathify={})}(this,function(t){"use strict";var e={store:{state:null,commit:function(){"production"!==process.env.NODE_ENV&&console.error("[Vuex Pathify] Plugin not initialized!")},dispatch:function(){"production"!==process.env.NODE_ENV&&console.error("[Vuex Pathify] Plugin not initialized!")}}};function n(t){return!!t&&"object"==typeof t}function r(t,e){return n(t)&&e in t}function o(t){return t?Array.isArray(t)?t.map(function(t){return String(t)}):"object"==typeof t?Object.keys(t):"string"==typeof t&&t.match(/[$\w]+/g)||[]:[]}function i(t,e){var r=t;return o(e).every(function(t){var e=function(t){return n(t)&&!Array.isArray(t)}(r)&&r.hasOwnProperty(t);return r=e?r[t]:void 0,e}),r}var u,s={mapping:"standard",strict:!0,cache:!0,deep:1},a={camel:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.shift()+t.map(function(t){return t.replace(/\w/,function(t){return t.toUpperCase()})}).join("")},snake:function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];return(t=this).camel.apply(t,e).replace(/([a-z])([A-Z])/g,function(t,e,n){return e+"_"+n}).toLowerCase()},const:function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];return(t=this).snake.apply(t,e).toUpperCase()}},c={state:"state",getters:"getters",actions:"_actions",mutations:"_mutations"},f={standard:function(t,e,n){switch(t){case"mutations":return n.const("set",e);case"actions":return n.camel("set",e)}return e},simple:function(t,e,n){return"actions"===t?n.camel("set",e):e}};function p(t,e){if(e.match(/!$/))return e.substr(0,e.length-1);var n=u;if(!n){if("function"==typeof s.mapping)n=s.mapping;else if(!(n=f[s.mapping]))throw new Error("[Vuex Pathify] Unknown mapping '"+s.mapping+"' in options\n    - Choose one of '"+Object.keys(f).join("', '")+"'\n    - Or, supply a custom function\n");u=n}return u(t,e,a)}function l(t,e){var i,u,s=e.replace(/[/@!]+/g,"."),a=e.split("@"),f=a[0],l=a[1];if(f.includes("/")){var d=f.split("/");u=d.pop(),i=d.join("/")}else u=f;if(i&&!t._modulesNamespaceMap[i+"/"])throw new Error("[Vuex Pathify] Unknown module '"+i+"' via path '"+e+"'");return{absPath:s,module:i,target:f,name:u.replace("!",""),get:function(e){var s=t[c[e]],a=p(e,u),f=i?i+"/"+a:a;return{exists:"state"===e?function(t,e){var i=o(e);if(n(t)){for(;i.length;){var u=i.shift();if(!r(t,u))return!1;t=t[u]}return!0}return!1}(s,f):f in s,member:s,type:f,name:a,path:l}}}}function d(t,e,n,r,o,i){var u="[Vuex Pathify] Unable to map path '"+t+"':";t.includes("!")?u+="\n    - Did not find "+n+" or "+o+" named '"+e.name+"' on "+(e.module?"module '"+e.module+"'":"root store"):u+="\n    - Did not find "+(r?n+" '"+r.name+"' or ":"")+(o+" '"+i.name+"'")+" on "+(e.module?"module '"+e.module+"'":"store")+"\n    - Use direct syntax '"+e.target.replace(/(@|$)/,"!$1")+"' (if member exists) to target directly";return u}var h=function(t,e,n){this.expr=t,this.path=e,this.value=n};function m(t,e){var n=l(t,e),r=n.get("actions");if(r.exists)return function(n){return t.dispatch(r.type,r.path?new h(e,r.path,n):n)};var o=n.get("mutations");return o.exists?function(n){return t.commit(o.type,o.path?new h(e,o.path,n):n)}:("production"!==process.env.NODE_ENV&&console.error(d(e,n,"action",r,"mutation",o)),function(t){})}function g(t,e,n){var r,o=l(t,e);if(!n&&(r=o.get("getters")).exists)return function(){var t=r.member[r.type];return r.path?y(e,t,r.path):t};var i=o.get("state");return i.exists?function(){return y(e,t.state,o.absPath)}:("production"!==process.env.NODE_ENV&&console.error(d(e,o,"getter",r,"state",i)),function(){})}function y(t,e,n){if(s.deep||!t.includes("@"))return i(e,n);console.error("[Vuex Pathify] Unable to access sub-property for path '"+t+"':\n    - Set option 'deep' to 1 to allow it")}function v(t){t.set=function(e,n){var r=m(t,e);if(void 0!==r)return r(n)},t.get=function(e){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];var o=g(t,e);if(void 0!==o){var i=o();return"function"==typeof i?i.apply(void 0,n):i}},t.copy=function(e){for(var r=[],o=arguments.length-1;o-- >0;)r[o]=arguments[o+1];var i,u=t.get.apply(t,[e].concat(r));return n(u)?(i=u,JSON.parse(JSON.stringify(i))):u}}function b(t){return p(t,"value")}h.prototype.update=function(t){return s.deep?function(t,e,r,o){void 0===o&&(o=!1);var i=e.split(".");return i.reduce(function(t,e,u){if(!t)return!1;if(u===i.length-1)return t[e]=r,!0;if(!(n(t[e])&&e in t)){if(!o)return!1;t[e]={}}return t[e]},t)}(t,this.path,this.value,s.deep>1)||"production"===process.env.NODE_ENV?Object.assign({},t):(console.error("[Vuex Pathify] Unable to create sub-property for path '"+this.expr+"':\n    - Set option 'deep' to 2 to allow it"),t):(console.error("[Vuex Pathify] Unable to access sub-property for path '"+this.expr+"':\n    - Set option 'deep' to 1 to allow it"),t)};var w={options:s,plugin:function(t){e.store=t,v(t)},debug:function(){console.log("\n  [Vuex Pathify] Options:\n\n  Mapping ("+("function"==typeof s.mapping?"custom":s.mapping)+")\n-------------------------------\n  path       : value\n  state      : "+b("state")+"\n  getters    : "+b("getters")+"\n  actions    : "+b("actions")+"\n  mutations  : "+b("mutations")+"\n\n  Settings\n-------------------------------\n  strict     : "+s.strict+"\n  cache      : "+s.cache+"\n  deep       : "+s.deep+"\n\n")}};function x(t){return o("function"==typeof t?t():t)}var $={getters:function(t){return x(t).reduce(function(t,e){return t[p("getters",e)]=function(t){return t[e]},t},{})},mutations:function(t){return x(t).reduce(function(t,e){return t[p("mutations",e)]=function(t,n){t[e]=n instanceof h?n.update(t[e]):n},t},{})},actions:function(t){return x(t).reduce(function(t,e){var n=p("actions",e),r=p("mutations",e);return t[n]=function(t,e){(0,t.commit)(r,e)},t},{})}};function P(t,e){var n=t.match(/([^/@\.]+)$/)[1],r=t.substring(0,t.length-n.length),o=r.replace(/\W+$/,"").split(/[/@.]/),u=r?i(e,o):e;if(!u)return console.error("[Vuex Pathify] Unable to expand wildcard path '"+t+"':\n    - It looks like '"+r.replace(/\W+$/,"")+"' does not resolve to an existing state property"),[];var s=new RegExp("^"+n.replace(/\*/g,"\\w+")+"$");return Object.keys(u).filter(function(t){return s.test(t)}).map(function(t){return r+t})}function O(t,e){var n=new RegExp("^"+t.replace(/\*/g,"\\w+")+"$");return Object.keys(e).filter(function(t){return n.test(t)})}function E(t,e){return t.includes("*")&&/\*.*[/@.]/.test(t)?(console.error("[Vuex Pathify] Invalid wildcard placement for path '"+t+"':\n    - Wildcards may only be used in the last segment of a path"),!1):!!e||(console.error("[Vuex Pathify] Unable to expand wildcard path '"+t+"':\n    - The usual reason for this is that the router was set up before the store\n    - Make sure the store is imported before the router, then reload"),!1)}function V(t,e){return void 0===e&&(e=""),((t=t.replace(/\/+$/,"")).includes("@")?t+"."+e:t+"/"+e).replace(/^\/|[.@/]+$/,"").replace(/\/@/,"@").replace(/@\./,"@")}function k(t){return t.reduce(function(t,e){return t[e.match(/\w+$/)]=e,t},{})}function j(t,n){return _(t,n,D,function(t){return function(t,e,n){return E(t,e)?P(t,e).concat(O(t,n)):""}(t,e.store.state,e.store.getters)})}function N(t,n){return _(t,n,A,function(t){return function(t,e){return E(t,e)?P(t,e):""}(t,e.store.state)})}function U(t,n){return _(t,n,M,function(t){return function(t,e){return E(t,e)?O(t,e):""}(t,e.store._actions)})}function _(t,e,r,o){var i=function(t,e,r){return"string"==typeof t&&t.includes("*")?k(r(t)):Array.isArray(t)?k(t):(n(t)&&(e=t,t=""),Array.isArray(e)?k(e.map(function(e){return V(t,e)})):n(e)?Object.keys(e).reduce(function(n,r){return n[r]=V(t,e[r]),n},{}):t)}(t,e,o);return"string"==typeof i?r(i):(Object.keys(i).forEach(function(t){i[t]=r(i[t])}),i)}function A(t){var e=t.split("|"),n=e[0],r=e[1];return r&&(r=n.replace(/\w+!?$/,r.replace("!","")+"!")),n&&r?{get:D(n,!0),set:S(r)}:{get:D(n,!0),set:S(n)}}function D(t,e){var n;return function(){for(var r=[],o=arguments.length;o--;)r[o]=arguments[o];if(!this.$store)throw new Error("[Vuex Pathify] Unexpected condition: this.$store is undefined.\n\nThis is a known edge case with some setups and will cause future lookups to fail");return n||(n=g(this.$store,t,e)),n.apply(void 0,r)}}function S(t){var e;return function(n){var r=this;return e||(e=m(this.$store,t)),this.$nextTick(function(){return r.$emit("sync",t,n)}),e(n)}}function M(t){return function(e){return this.$store.dispatch(t,e)}}var C=require("vue-class-component").createDecorator;t.default=w,t.make=$,t.Payload=h,t.get=j,t.sync=N,t.call=U,t.Get=function(t){if("string"!=typeof t||arguments.length>1)throw new Error("Property decorators can be used for single property access");return C(function(e,n){e.computed||(e.computed={}),e.computed[n]=j(t)})},t.Sync=function(t){if("string"!=typeof t||arguments.length>1)throw new Error("Property decorators can be used for single property access");return C(function(e,n){e.computed||(e.computed={}),e.computed[n]=N(t)})},t.Call=function(t){if("string"!=typeof t||arguments.length>1)throw new Error("Property decorators can be used for single property access");return C(function(e,n){e.methods||(e.methods={}),e.methods[n]=U(t)})},t.commit=function(){for(var t,n=[],r=arguments.length;r--;)n[r]=arguments[r];(t=e.store).commit.apply(t,n)},t.dispatch=function(){for(var t,n=[],r=arguments.length;r--;)n[r]=arguments[r];return(t=e.store).dispatch.apply(t,n)},t.registerModule=function(t,e,n,r){return{beforeCreate:function(){this.$store.registerModule(t,e,r);var o=n();this.$options.computed=Object.assign(this.$options.computed||{},o.computed||{}),this.$options.methods=Object.assign(this.$options.methods||{},o.methods||{})},destoyed:function(){this.$store.unregisterModule(t)}}},Object.defineProperty(t,"__esModule",{value:!0})});
